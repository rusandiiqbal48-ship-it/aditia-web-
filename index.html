<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kisi-kisi ASJ 2025 — Soal & Kunci Jawaban</title>
  <link rel="stylesheet" href="styles.css" />
  <meta name="description" content="Kisi-kisi ASJ 2025 — Soal Pilihan Ganda dan Esai beserta kunci jawaban." />
</head>
<body>
  <div class="bg-grid"></div>

  <header class="header">
    <div class="brand">
      <h1>Kisi-kisi ASJ 2025</h1>
      <p class="subtitle">Soal dan Kunci Jawaban — Administrasi Sistem Jaringan (Kelas XII TKJ)</p>
    </div>
    <div class="controls">
      <input id="search" type="search" placeholder="Cari nomor/keyword (mis. 'hosting', 'Proxmox')" />
      <select id="filter">
        <option value="all">Semua</option>
        <option value="mc">Pilihan Ganda</option>
        <option value="essay">Esai</option>
      </select>
      <button id="expandAll">Buka Semua</button>
      <button id="collapseAll">Tutup Semua</button>
    </div>
  </header>

  <main class="container">
    <section id="qa-list" class="qa-list" aria-live="polite">
      <!-- Konten terisi melalui data.js -->
    </section>
  </main>

  <footer class="footer">
    <div>Generated by ChatGPT — Rifqi / Fahatir</div>
    <div class="foot-right">File sumber: <em>Kisi-kisi ASJ 2025.pdf</em></div>
  </footer>

  <template id="card-template">
    <article class="card">
      <header class="card-head">
        <div class="meta">
          <span class="num"></span>
          <span class="type"></span>
        </div>
        <button class="toggle">+</button>
      </header>
      <div class="card-body">
        <p class="question"></p>
        <div class="answer-block">
          <h4>Jawaban</h4>
          <p class="answer"></p>
        </div>
      </div>
    </article>
  </template>

  <script src="data.js"></script>
  <script>
    // Render Q&A dari data.js
    const listEl = document.getElementById('qa-list');
    const tpl = document.getElementById('card-template');
    const searchInput = document.getElementById('search');
    const filterEl = document.getElementById('filter');
    const expandAllBtn = document.getElementById('expandAll');
    const collapseAllBtn = document.getElementById('collapseAll');

    function render(items) {
      listEl.innerHTML = '';
      if (!items.length) {
        listEl.innerHTML = '<p class="empty">Tidak ada soal sesuai filter/pencarian.</p>';
        return;
      }
      items.forEach(it => {
        const node = tpl.content.cloneNode(true);
        const card = node.querySelector('.card');
        node.querySelector('.num').textContent = `No. ${it.number}`;
        node.querySelector('.type').textContent = it.type === 'mc' ? ' (Pilihan Ganda)' : ' (Esai)';
        node.querySelector('.question').innerHTML = it.questionHtml || escapeHtml(it.question);
        node.querySelector('.answer').innerHTML = it.answerHtml || escapeHtml(it.answer);
        const toggle = node.querySelector('.toggle');
        const body = node.querySelector('.card-body');

        toggle.addEventListener('click', () => {
          const opened = card.classList.toggle('open');
          toggle.textContent = opened ? '−' : '+';
        });

        // open if 'open' flag
        if (it.open) {
          card.classList.add('open');
          toggle.textContent = '−';
        }

        listEl.appendChild(node);
      });
    }

    function escapeHtml(s) {
      return (s || '').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('\n','<br>');
    }

    function applyFilter() {
      const q = searchInput.value.trim().toLowerCase();
      const f = filterEl.value;
      const filtered = QA_DATA.filter(it => {
        if (f !== 'all' && it.type !== f) return false;
        if (!q) return true;
        const hay = ((it.question + ' ' + it.answer + ' ' + (it.tags||'')).toLowerCase());
        return hay.includes(q) || String(it.number) === q;
      });
      render(filtered);
    }

    searchInput.addEventListener('input', applyFilter);
    filterEl.addEventListener('change', applyFilter);
    expandAllBtn.addEventListener('click', () => {
      document.querySelectorAll('.card').forEach(c => c.classList.add('open'));
      document.querySelectorAll('.toggle').forEach(t => t.textContent='−');
    });
    collapseAllBtn.addEventListener('click', () => {
      document.querySelectorAll('.card').forEach(c => c.classList.remove('open'));
      document.querySelectorAll('.toggle').forEach(t => t.textContent='+');
    });

    // initial render
    render(QA_DATA);
  </script>
</body>
</html>
